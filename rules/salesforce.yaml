- rule: Successful Login
  desc: User logged on successfully
  condition: salesforce.eventtype=LoginEvent and salesforce.loginstatus=Success
  output: >
    User %salesforce.username logged on successfully (source IP=%salesforce.sourceip, city=%salesforce.city, country=%salesforce.country, platform=%salesforce.platform, browser=%salesforce.browser)
  priority: INFORMATIONAL
  source: salesforce
  tags: [salesforce]

- rule: Failed Login
  desc: User failed login
  condition: salesforce.eventtype=LoginEvent and salesforce.loginstatus!="Success"
  output: >
    User %salesforce.username failed login  (status=%salesforce.loginstatus, source IP=%salesforce.sourceip, city=%salesforce.city, country=%salesforce.country, platform=%salesforce.platform, browser=%salesforce.browser)
  priority: ALERT
  source: salesforce
  tags: [salesforce]

- rule: User Logged out
  desc: User Logged out
  condition: salesforce.eventtype=LogoutEvent
  output: >
    User %salesforce.username logged out successfully (source IP=%salesforce.sourceip, platform=%salesforce.platform)
  priority: INFORMATIONAL
  source: salesforce
  tags: [salesforce]

- rule: Administrator logged on as another user
  desc: User logged on successfully
  condition: salesforce.eventtype=LoginAsEvent 
  output: >
    User %salesforce.delegatedusername from Organisation ID %salesforce.delegatedorganizationid logged on successfully as %salesforce.username (source IP=%salesforce.sourceip, targetURL=%salesforce.targeturl, platform=%salesforce.platform, browser=%salesforce.browser)
  priority: WARNING
  source: salesforce
  tags: [salesforce]

- rule: Detected Session being Hijacked
  desc: Detected Session being Hijacked
  condition: salesforce.eventtype=SessionHijackingEvent 
  output: >
    Detected Session being hijacked (User=%salesforce.delegatedusername with Previous IP=%salesforce.previousip, being hijacked by IP=%salesforce.currentip on platform %salesforce.currentplatform and User Agent=%salesforce.currentuseragent  )
  priority: EMERGENCY
  source: salesforce
  tags: [salesforce]
